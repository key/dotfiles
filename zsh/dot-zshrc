bindkey -e

# M-f/M-bの挙動をEmacsのそれに合わせる（実はM-bは元々同じだけど一応）
bindkey "^[f" emacs-forward-word
bindkey "^[b" emacs-backward-word

# M-f/M-b/M-dなどでの単語境界の基準をEmacsライクに
export WORDCHARS=""

setopt auto_cd
setopt nobeep

# history settings
HISTFILE=$HOME/.zsh-history
HISTSIZE=100000
SAVEHIST=100000

setopt share_history
setopt hist_ignore_dups
setopt extended_history

# zsh-completionsの設定
fpath=(~/.zsh.d/ $fpath)
fpath=($HOME/.anyenv/completions/ $fpath)
fpath=(/usr/local/share/zsh/site-functions $fpath)

autoload -U compinit
compinit -u

autoload history-search-end
autoload -U colors; colors
autoload -U compinit; compinit
autoload -Uz vcs_info
zstyle ':vcs_info:*' formats ':(%s)%b'
zstyle ':vcs_info:*' actionformats ':(%s)%b|%a'
precmd () {
    psvar=()
    LANG=en_US.UTF-8 vcs_info
    [[ -n "$vcs_info_msg_0_" ]] && psvar[1]="$vcs_info_msg_0_"
}

PROMPT="%{${fg[yellow]}%}[%n@%m%1(v|%F{green}%1v%f|)%{${fg[yellow]}%}]%{${reset_color}%}%b "
# PROMPT='$USER@%m%%%u '
# PROMPT='$USER@'`hostname -s`'%%%u '
RPROMPT='[%~]'
setopt prompt_subst
unsetopt promptcr

#autoload -U sshsocket

# setopt listtype

export PATH=${HOME}/local/bin:/usr/local/bin:/usr/bin:/bin:/usr/X11R6/bin:/usr/local/sbin:/usr/sbin:/sbin:/usr/local/opt/gettext/bin
export MANPATH=/usr/share/man:/usr/local/man:/usr/X11R6/man
export LANG=ja_JP.UTF-8
export EDITOR=vi
export RSYNC_SSH=ssh

alias rgrep="grep -r"
alias less="less -R"
alias ll="ls -l"
alias la="ls -a"
alias rm="rm -i"
alias cp="cp -i"
alias mv="mv -i"
#alias ssh='SSH_AUTH_SOCK=`sshsocket` ssh'

# create zsh.d if directory not exists.
if [ ! -d $HOME/.zsh.d/ ]; then
    echo "can't find ~/.zsh.d/"
    echo 'so create that'
    mkdir $HOME/.zsh.d/
fi

# editor
if [ -f /usr/bin/vim ]; then
    alias vi=vim
fi

##
## PATH setting
##

# PostgreSQL
if [ -d /usr/local/pgsql/bin ]; then
    export PATH=/usr/local/pgsql/bin:$PATH
    export MANPATAH=/usr/local/pgsql/man:$MANPATH
fi

# python
export WORKON_HOME=${HOME}/Documents/virtualenv
export PIP_DOWNLOAD_CACHE=~/.pip_cache
export PIP_RESPECT_VIRTUALENV=true
export PIPENV_VENV_IN_PROJECT=yes

if [ -f ${HOME}/.pythonrc.py ]; then
    export PYTHONSTARTUP=${HOME}/.pythonrc.py
fi

# anyenv
if [ -d $HOME/.anyenv ] ; then
    export PATH="$HOME/.anyenv/bin:$PATH"
    eval "$(anyenv init - zsh)"
fi

# pyenv
if [ -f /usr/local/bin/pyenv ]; then
    export PYENV_ROOT=${HOME}/.pyenv
    export PATH=${PYENV_ROOT}/bin:$PATH
    eval "$(pyenv init -)"
    eval "$(pyenv virtualenv-init -)"
fi

# rbenv
if [ -f /usr/local/bin/rbenv ]; then
    export RBENV_ROOT=${HOME}/.rbenv
    export PATH=${RBENV_ROOT}/bin:$PATH
    eval "$(rbenv init -)"
fi

# goenv
if [ -f /usr/local/bin/goenv ]; then
    export GOPATH=$HOME/go
    export PATH=$PATH:$GOROOT/bin:$GOPATH/bin
    eval "$(goenv init -)"
fi

# direnv
if [ -f /usr/local/bin/direnv ]; then
    eval "$(direnv hook zsh)"
fi

# fastlane
if [ -d ~/.fastlane ]; then
    export PATH="$HOME/.fastlane/bin:$PATH"
fi

# aws cli v1
if [ -d /usr/local/opt/awscli@1/bin ]; then
    alias awsv1=/usr/local/opt/awscli@1/bin/aws
fi
